meta {
  name: pegar token
  type: http
  seq: 7
}

post {
  url: {{base_URL_keycloak}}/realms/desafio-itau/protocol/openid-connect/token
  body: formUrlEncoded
  auth: none
}

body:form-urlencoded {
  grant_type: client_credentials
  client_id: api-contratos
  client_secret: {{token}}
}

tests {
  const jsonData = res.getBody();
  
  if (jsonData && jsonData.access_token) {
  
    bru.setVar('bearer_token', jsonData.access_token);
  }
}

settings {
  encodeUrl: true
  timeout: 0
}
